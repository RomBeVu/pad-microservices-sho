{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { context as contextApi, diag, ValueType } from '@opentelemetry/api';\nimport { millisToHrTime } from '@opentelemetry/core';\nexport class SyncInstrument {\n  _writableMetricStorage;\n  _descriptor;\n  constructor(_writableMetricStorage, _descriptor) {\n    this._writableMetricStorage = _writableMetricStorage;\n    this._descriptor = _descriptor;\n  }\n  _record(value, attributes = {}, context = contextApi.active()) {\n    if (typeof value !== 'number') {\n      diag.warn(`non-number value provided to metric ${this._descriptor.name}: ${value}`);\n      return;\n    }\n    if (this._descriptor.valueType === ValueType.INT && !Number.isInteger(value)) {\n      diag.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`);\n      value = Math.trunc(value);\n      // ignore non-finite values.\n      if (!Number.isInteger(value)) {\n        return;\n      }\n    }\n    this._writableMetricStorage.record(value, attributes, context, millisToHrTime(Date.now()));\n  }\n}\n/**\n * The class implements {@link UpDownCounter} interface.\n */\nexport class UpDownCounterInstrument extends SyncInstrument {\n  /**\n   * Increment value of counter by the input. Inputs may be negative.\n   */\n  add(value, attributes, ctx) {\n    this._record(value, attributes, ctx);\n  }\n}\n/**\n * The class implements {@link Counter} interface.\n */\nexport class CounterInstrument extends SyncInstrument {\n  /**\n   * Increment value of counter by the input. Inputs may not be negative.\n   */\n  add(value, attributes, ctx) {\n    if (value < 0) {\n      diag.warn(`negative value provided to counter ${this._descriptor.name}: ${value}`);\n      return;\n    }\n    this._record(value, attributes, ctx);\n  }\n}\n/**\n * The class implements {@link Gauge} interface.\n */\nexport class GaugeInstrument extends SyncInstrument {\n  /**\n   * Records a measurement.\n   */\n  record(value, attributes, ctx) {\n    this._record(value, attributes, ctx);\n  }\n}\n/**\n * The class implements {@link Histogram} interface.\n */\nexport class HistogramInstrument extends SyncInstrument {\n  /**\n   * Records a measurement. Value of the measurement must not be negative.\n   */\n  record(value, attributes, ctx) {\n    if (value < 0) {\n      diag.warn(`negative value provided to histogram ${this._descriptor.name}: ${value}`);\n      return;\n    }\n    this._record(value, attributes, ctx);\n  }\n}\nexport class ObservableInstrument {\n  _observableRegistry;\n  /** @internal */\n  _metricStorages;\n  /** @internal */\n  _descriptor;\n  constructor(descriptor, metricStorages, _observableRegistry) {\n    this._observableRegistry = _observableRegistry;\n    this._descriptor = descriptor;\n    this._metricStorages = metricStorages;\n  }\n  /**\n   * @see {Observable.addCallback}\n   */\n  addCallback(callback) {\n    this._observableRegistry.addCallback(callback, this);\n  }\n  /**\n   * @see {Observable.removeCallback}\n   */\n  removeCallback(callback) {\n    this._observableRegistry.removeCallback(callback, this);\n  }\n}\nexport class ObservableCounterInstrument extends ObservableInstrument {}\nexport class ObservableGaugeInstrument extends ObservableInstrument {}\nexport class ObservableUpDownCounterInstrument extends ObservableInstrument {}\nexport function isObservableInstrument(it) {\n  return it instanceof ObservableInstrument;\n}","map":{"version":3,"names":["context","contextApi","diag","ValueType","millisToHrTime","SyncInstrument","_writableMetricStorage","_descriptor","constructor","_record","value","attributes","active","warn","name","valueType","INT","Number","isInteger","Math","trunc","record","Date","now","UpDownCounterInstrument","add","ctx","CounterInstrument","GaugeInstrument","HistogramInstrument","ObservableInstrument","_observableRegistry","_metricStorages","descriptor","metricStorages","addCallback","callback","removeCallback","ObservableCounterInstrument","ObservableGaugeInstrument","ObservableUpDownCounterInstrument","isObservableInstrument","it"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/sdk-metrics/src/Instruments.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  context as contextApi,\n  diag,\n  Context,\n  Attributes,\n  ValueType,\n  UpDownCounter,\n  Counter,\n  Gauge,\n  Histogram,\n  Observable,\n  ObservableCallback,\n  ObservableCounter,\n  ObservableGauge,\n  ObservableUpDownCounter,\n} from '@opentelemetry/api';\nimport { millisToHrTime } from '@opentelemetry/core';\nimport { InstrumentDescriptor } from './InstrumentDescriptor';\nimport { ObservableRegistry } from './state/ObservableRegistry';\nimport {\n  AsyncWritableMetricStorage,\n  WritableMetricStorage,\n} from './state/WritableMetricStorage';\n\nexport class SyncInstrument {\n  constructor(\n    private _writableMetricStorage: WritableMetricStorage,\n    protected _descriptor: InstrumentDescriptor\n  ) {}\n\n  protected _record(\n    value: number,\n    attributes: Attributes = {},\n    context: Context = contextApi.active()\n  ) {\n    if (typeof value !== 'number') {\n      diag.warn(\n        `non-number value provided to metric ${this._descriptor.name}: ${value}`\n      );\n      return;\n    }\n    if (\n      this._descriptor.valueType === ValueType.INT &&\n      !Number.isInteger(value)\n    ) {\n      diag.warn(\n        `INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`\n      );\n      value = Math.trunc(value);\n      // ignore non-finite values.\n      if (!Number.isInteger(value)) {\n        return;\n      }\n    }\n    this._writableMetricStorage.record(\n      value,\n      attributes,\n      context,\n      millisToHrTime(Date.now())\n    );\n  }\n}\n\n/**\n * The class implements {@link UpDownCounter} interface.\n */\nexport class UpDownCounterInstrument\n  extends SyncInstrument\n  implements UpDownCounter\n{\n  /**\n   * Increment value of counter by the input. Inputs may be negative.\n   */\n  add(value: number, attributes?: Attributes, ctx?: Context): void {\n    this._record(value, attributes, ctx);\n  }\n}\n\n/**\n * The class implements {@link Counter} interface.\n */\nexport class CounterInstrument extends SyncInstrument implements Counter {\n  /**\n   * Increment value of counter by the input. Inputs may not be negative.\n   */\n  add(value: number, attributes?: Attributes, ctx?: Context): void {\n    if (value < 0) {\n      diag.warn(\n        `negative value provided to counter ${this._descriptor.name}: ${value}`\n      );\n      return;\n    }\n\n    this._record(value, attributes, ctx);\n  }\n}\n\n/**\n * The class implements {@link Gauge} interface.\n */\nexport class GaugeInstrument extends SyncInstrument implements Gauge {\n  /**\n   * Records a measurement.\n   */\n  record(value: number, attributes?: Attributes, ctx?: Context): void {\n    this._record(value, attributes, ctx);\n  }\n}\n\n/**\n * The class implements {@link Histogram} interface.\n */\nexport class HistogramInstrument extends SyncInstrument implements Histogram {\n  /**\n   * Records a measurement. Value of the measurement must not be negative.\n   */\n  record(value: number, attributes?: Attributes, ctx?: Context): void {\n    if (value < 0) {\n      diag.warn(\n        `negative value provided to histogram ${this._descriptor.name}: ${value}`\n      );\n      return;\n    }\n    this._record(value, attributes, ctx);\n  }\n}\n\nexport class ObservableInstrument implements Observable {\n  /** @internal */\n  _metricStorages: AsyncWritableMetricStorage[];\n  /** @internal */\n  _descriptor: InstrumentDescriptor;\n\n  constructor(\n    descriptor: InstrumentDescriptor,\n    metricStorages: AsyncWritableMetricStorage[],\n    private _observableRegistry: ObservableRegistry\n  ) {\n    this._descriptor = descriptor;\n    this._metricStorages = metricStorages;\n  }\n\n  /**\n   * @see {Observable.addCallback}\n   */\n  addCallback(callback: ObservableCallback) {\n    this._observableRegistry.addCallback(callback, this);\n  }\n\n  /**\n   * @see {Observable.removeCallback}\n   */\n  removeCallback(callback: ObservableCallback) {\n    this._observableRegistry.removeCallback(callback, this);\n  }\n}\n\nexport class ObservableCounterInstrument\n  extends ObservableInstrument\n  implements ObservableCounter {}\nexport class ObservableGaugeInstrument\n  extends ObservableInstrument\n  implements ObservableGauge {}\nexport class ObservableUpDownCounterInstrument\n  extends ObservableInstrument\n  implements ObservableUpDownCounter {}\n\nexport function isObservableInstrument(\n  it: unknown\n): it is ObservableInstrument {\n  return it instanceof ObservableInstrument;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}