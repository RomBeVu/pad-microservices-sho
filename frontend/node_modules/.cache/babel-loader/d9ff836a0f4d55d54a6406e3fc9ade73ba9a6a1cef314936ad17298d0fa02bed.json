{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { otperformance } from '@opentelemetry/core';\nimport { hasKey, PerformanceTimingNames as PTN } from '@opentelemetry/sdk-trace-web';\nimport { EventNames } from './enums/EventNames';\nexport const getPerformanceNavigationEntries = () => {\n  const entries = {};\n  const performanceNavigationTiming = otperformance.getEntriesByType?.('navigation')[0];\n  if (performanceNavigationTiming) {\n    const keys = Object.values(PTN);\n    keys.forEach(key => {\n      if (hasKey(performanceNavigationTiming, key)) {\n        const value = performanceNavigationTiming[key];\n        if (typeof value === 'number') {\n          entries[key] = value;\n        }\n      }\n    });\n  } else {\n    // // fallback to previous version\n    const perf = otperformance;\n    const performanceTiming = perf.timing;\n    if (performanceTiming) {\n      const keys = Object.values(PTN);\n      keys.forEach(key => {\n        if (hasKey(performanceTiming, key)) {\n          const value = performanceTiming[key];\n          if (typeof value === 'number') {\n            entries[key] = value;\n          }\n        }\n      });\n    }\n  }\n  return entries;\n};\nconst performancePaintNames = {\n  'first-paint': EventNames.FIRST_PAINT,\n  'first-contentful-paint': EventNames.FIRST_CONTENTFUL_PAINT\n};\nexport const addSpanPerformancePaintEvents = span => {\n  const performancePaintTiming = otperformance.getEntriesByType?.('paint');\n  if (performancePaintTiming) {\n    performancePaintTiming.forEach(({\n      name,\n      startTime\n    }) => {\n      if (hasKey(performancePaintNames, name)) {\n        span.addEvent(performancePaintNames[name], startTime);\n      }\n    });\n  }\n};","map":{"version":3,"names":["otperformance","hasKey","PerformanceTimingNames","PTN","EventNames","getPerformanceNavigationEntries","entries","performanceNavigationTiming","getEntriesByType","keys","Object","values","forEach","key","value","perf","performanceTiming","timing","performancePaintNames","FIRST_PAINT","FIRST_CONTENTFUL_PAINT","addSpanPerformancePaintEvents","span","performancePaintTiming","name","startTime","addEvent"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/instrumentation-document-load/src/utils.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Span } from '@opentelemetry/api';\nimport { otperformance } from '@opentelemetry/core';\nimport {\n  hasKey,\n  PerformanceEntries,\n  PerformanceLegacy,\n  PerformanceTimingNames as PTN,\n} from '@opentelemetry/sdk-trace-web';\nimport { EventNames } from './enums/EventNames';\n\nexport const getPerformanceNavigationEntries = (): PerformanceEntries => {\n  const entries: PerformanceEntries = {};\n  const performanceNavigationTiming = (\n    otperformance as unknown as Performance\n  ).getEntriesByType?.('navigation')[0] as PerformanceEntries;\n\n  if (performanceNavigationTiming) {\n    const keys = Object.values(PTN);\n    keys.forEach((key: string) => {\n      if (hasKey(performanceNavigationTiming, key)) {\n        const value = performanceNavigationTiming[key];\n        if (typeof value === 'number') {\n          entries[key] = value;\n        }\n      }\n    });\n  } else {\n    // // fallback to previous version\n    const perf: typeof otperformance & PerformanceLegacy = otperformance;\n    const performanceTiming = perf.timing;\n    if (performanceTiming) {\n      const keys = Object.values(PTN);\n      keys.forEach((key: string) => {\n        if (hasKey(performanceTiming, key)) {\n          const value = performanceTiming[key];\n          if (typeof value === 'number') {\n            entries[key] = value;\n          }\n        }\n      });\n    }\n  }\n\n  return entries;\n};\n\nconst performancePaintNames = {\n  'first-paint': EventNames.FIRST_PAINT,\n  'first-contentful-paint': EventNames.FIRST_CONTENTFUL_PAINT,\n};\n\nexport const addSpanPerformancePaintEvents = (span: Span) => {\n  const performancePaintTiming = (\n    otperformance as unknown as Performance\n  ).getEntriesByType?.('paint');\n  if (performancePaintTiming) {\n    performancePaintTiming.forEach(({ name, startTime }) => {\n      if (hasKey(performancePaintNames, name)) {\n        span.addEvent(performancePaintNames[name], startTime);\n      }\n    });\n  }\n};\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAiBA,SAASA,aAAa,QAAQ,qBAAqB;AACnD,SACEC,MAAM,EAGNC,sBAAsB,IAAIC,GAAG,QACxB,8BAA8B;AACrC,SAASC,UAAU,QAAQ,oBAAoB;AAE/C,OAAO,MAAMC,+BAA+B,GAAGA,CAAA,KAAyB;EACtE,MAAMC,OAAO,GAAuB,EAAE;EACtC,MAAMC,2BAA2B,GAC/BP,aACD,CAACQ,gBAAgB,GAAG,YAAY,CAAC,CAAC,CAAC,CAAuB;EAE3D,IAAID,2BAA2B,EAAE;IAC/B,MAAME,IAAI,GAAGC,MAAM,CAACC,MAAM,CAACR,GAAG,CAAC;IAC/BM,IAAI,CAACG,OAAO,CAAEC,GAAW,IAAI;MAC3B,IAAIZ,MAAM,CAACM,2BAA2B,EAAEM,GAAG,CAAC,EAAE;QAC5C,MAAMC,KAAK,GAAGP,2BAA2B,CAACM,GAAG,CAAC;QAC9C,IAAI,OAAOC,KAAK,KAAK,QAAQ,EAAE;UAC7BR,OAAO,CAACO,GAAG,CAAC,GAAGC,KAAK;;;IAG1B,CAAC,CAAC;GACH,MAAM;IACL;IACA,MAAMC,IAAI,GAA6Cf,aAAa;IACpE,MAAMgB,iBAAiB,GAAGD,IAAI,CAACE,MAAM;IACrC,IAAID,iBAAiB,EAAE;MACrB,MAAMP,IAAI,GAAGC,MAAM,CAACC,MAAM,CAACR,GAAG,CAAC;MAC/BM,IAAI,CAACG,OAAO,CAAEC,GAAW,IAAI;QAC3B,IAAIZ,MAAM,CAACe,iBAAiB,EAAEH,GAAG,CAAC,EAAE;UAClC,MAAMC,KAAK,GAAGE,iBAAiB,CAACH,GAAG,CAAC;UACpC,IAAI,OAAOC,KAAK,KAAK,QAAQ,EAAE;YAC7BR,OAAO,CAACO,GAAG,CAAC,GAAGC,KAAK;;;MAG1B,CAAC,CAAC;;;EAIN,OAAOR,OAAO;AAChB,CAAC;AAED,MAAMY,qBAAqB,GAAG;EAC5B,aAAa,EAAEd,UAAU,CAACe,WAAW;EACrC,wBAAwB,EAAEf,UAAU,CAACgB;CACtC;AAED,OAAO,MAAMC,6BAA6B,GAAIC,IAAU,IAAI;EAC1D,MAAMC,sBAAsB,GAC1BvB,aACD,CAACQ,gBAAgB,GAAG,OAAO,CAAC;EAC7B,IAAIe,sBAAsB,EAAE;IAC1BA,sBAAsB,CAACX,OAAO,CAAC,CAAC;MAAEY,IAAI;MAAEC;IAAS,CAAE,KAAI;MACrD,IAAIxB,MAAM,CAACiB,qBAAqB,EAAEM,IAAI,CAAC,EAAE;QACvCF,IAAI,CAACI,QAAQ,CAACR,qBAAqB,CAACM,IAAI,CAAC,EAAEC,SAAS,CAAC;;IAEzD,CAAC,CAAC;;AAEN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}