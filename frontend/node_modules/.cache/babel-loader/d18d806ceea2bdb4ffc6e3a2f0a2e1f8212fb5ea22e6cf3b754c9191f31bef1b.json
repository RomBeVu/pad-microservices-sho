{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getSharedConfigurationDefaults, mergeOtlpSharedConfigurationWithDefaults } from './shared-configuration';\nimport { validateAndNormalizeHeaders } from '../util';\nfunction mergeHeaders(userProvidedHeaders, fallbackHeaders, defaultHeaders) {\n  const requiredHeaders = {\n    ...defaultHeaders()\n  };\n  const headers = {};\n  return () => {\n    // add fallback ones first\n    if (fallbackHeaders != null) {\n      Object.assign(headers, fallbackHeaders());\n    }\n    // override with user-provided ones\n    if (userProvidedHeaders != null) {\n      Object.assign(headers, userProvidedHeaders());\n    }\n    // override required ones.\n    return Object.assign(headers, requiredHeaders);\n  };\n}\nfunction validateUserProvidedUrl(url) {\n  if (url == null) {\n    return undefined;\n  }\n  try {\n    new URL(url);\n    return url;\n  } catch (e) {\n    throw new Error(`Configuration: Could not parse user-provided export URL: '${url}'`);\n  }\n}\n/**\n * @param userProvidedConfiguration  Configuration options provided by the user in code.\n * @param fallbackConfiguration Fallback to use when the {@link userProvidedConfiguration} does not specify an option.\n * @param defaultConfiguration The defaults as defined by the exporter specification\n */\nexport function mergeOtlpHttpConfigurationWithDefaults(userProvidedConfiguration, fallbackConfiguration, defaultConfiguration) {\n  return {\n    ...mergeOtlpSharedConfigurationWithDefaults(userProvidedConfiguration, fallbackConfiguration, defaultConfiguration),\n    headers: mergeHeaders(validateAndNormalizeHeaders(userProvidedConfiguration.headers), fallbackConfiguration.headers, defaultConfiguration.headers),\n    url: validateUserProvidedUrl(userProvidedConfiguration.url) ?? fallbackConfiguration.url ?? defaultConfiguration.url,\n    agentOptions: userProvidedConfiguration.agentOptions ?? fallbackConfiguration.agentOptions ?? defaultConfiguration.agentOptions\n  };\n}\nexport function getHttpConfigurationDefaults(requiredHeaders, signalResourcePath) {\n  return {\n    ...getSharedConfigurationDefaults(),\n    headers: () => requiredHeaders,\n    url: 'http://localhost:4318/' + signalResourcePath,\n    agentOptions: {\n      keepAlive: true\n    }\n  };\n}","map":{"version":3,"names":["getSharedConfigurationDefaults","mergeOtlpSharedConfigurationWithDefaults","validateAndNormalizeHeaders","mergeHeaders","userProvidedHeaders","fallbackHeaders","defaultHeaders","requiredHeaders","headers","Object","assign","validateUserProvidedUrl","url","undefined","URL","e","Error","mergeOtlpHttpConfigurationWithDefaults","userProvidedConfiguration","fallbackConfiguration","defaultConfiguration","agentOptions","getHttpConfigurationDefaults","signalResourcePath","keepAlive"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/otlp-exporter-base/src/configuration/otlp-http-configuration.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getSharedConfigurationDefaults,\n  mergeOtlpSharedConfigurationWithDefaults,\n  OtlpSharedConfiguration,\n} from './shared-configuration';\nimport { validateAndNormalizeHeaders } from '../util';\n\n// NOTE: do not change these imports to be actual imports, otherwise they WILL break `@opentelemetry/instrumentation-http`\nimport type * as http from 'http';\nimport type * as https from 'https';\n\nexport interface OtlpHttpConfiguration extends OtlpSharedConfiguration {\n  url: string;\n  headers: () => Record<string, string>;\n  agentOptions: http.AgentOptions | https.AgentOptions;\n}\n\nfunction mergeHeaders(\n  userProvidedHeaders: (() => Record<string, string>) | undefined | null,\n  fallbackHeaders: (() => Record<string, string>) | undefined | null,\n  defaultHeaders: () => Record<string, string>\n): () => Record<string, string> {\n  const requiredHeaders = {\n    ...defaultHeaders(),\n  };\n  const headers = {};\n\n  return () => {\n    // add fallback ones first\n    if (fallbackHeaders != null) {\n      Object.assign(headers, fallbackHeaders());\n    }\n\n    // override with user-provided ones\n    if (userProvidedHeaders != null) {\n      Object.assign(headers, userProvidedHeaders());\n    }\n\n    // override required ones.\n    return Object.assign(headers, requiredHeaders);\n  };\n}\n\nfunction validateUserProvidedUrl(url: string | undefined): string | undefined {\n  if (url == null) {\n    return undefined;\n  }\n  try {\n    new URL(url);\n    return url;\n  } catch (e) {\n    throw new Error(\n      `Configuration: Could not parse user-provided export URL: '${url}'`\n    );\n  }\n}\n\n/**\n * @param userProvidedConfiguration  Configuration options provided by the user in code.\n * @param fallbackConfiguration Fallback to use when the {@link userProvidedConfiguration} does not specify an option.\n * @param defaultConfiguration The defaults as defined by the exporter specification\n */\nexport function mergeOtlpHttpConfigurationWithDefaults(\n  userProvidedConfiguration: Partial<OtlpHttpConfiguration>,\n  fallbackConfiguration: Partial<OtlpHttpConfiguration>,\n  defaultConfiguration: OtlpHttpConfiguration\n): OtlpHttpConfiguration {\n  return {\n    ...mergeOtlpSharedConfigurationWithDefaults(\n      userProvidedConfiguration,\n      fallbackConfiguration,\n      defaultConfiguration\n    ),\n    headers: mergeHeaders(\n      validateAndNormalizeHeaders(userProvidedConfiguration.headers),\n      fallbackConfiguration.headers,\n      defaultConfiguration.headers\n    ),\n    url:\n      validateUserProvidedUrl(userProvidedConfiguration.url) ??\n      fallbackConfiguration.url ??\n      defaultConfiguration.url,\n    agentOptions:\n      userProvidedConfiguration.agentOptions ??\n      fallbackConfiguration.agentOptions ??\n      defaultConfiguration.agentOptions,\n  };\n}\n\nexport function getHttpConfigurationDefaults(\n  requiredHeaders: Record<string, string>,\n  signalResourcePath: string\n): OtlpHttpConfiguration {\n  return {\n    ...getSharedConfigurationDefaults(),\n    headers: () => requiredHeaders,\n    url: 'http://localhost:4318/' + signalResourcePath,\n    agentOptions: { keepAlive: true },\n  };\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAgBA,SACEA,8BAA8B,EAC9BC,wCAAwC,QAEnC,wBAAwB;AAC/B,SAASC,2BAA2B,QAAQ,SAAS;AAYrD,SAASC,YAAYA,CACnBC,mBAAsE,EACtEC,eAAkE,EAClEC,cAA4C;EAE5C,MAAMC,eAAe,GAAG;IACtB,GAAGD,cAAc;GAClB;EACD,MAAME,OAAO,GAAG,EAAE;EAElB,OAAO,MAAK;IACV;IACA,IAAIH,eAAe,IAAI,IAAI,EAAE;MAC3BI,MAAM,CAACC,MAAM,CAACF,OAAO,EAAEH,eAAe,EAAE,CAAC;;IAG3C;IACA,IAAID,mBAAmB,IAAI,IAAI,EAAE;MAC/BK,MAAM,CAACC,MAAM,CAACF,OAAO,EAAEJ,mBAAmB,EAAE,CAAC;;IAG/C;IACA,OAAOK,MAAM,CAACC,MAAM,CAACF,OAAO,EAAED,eAAe,CAAC;EAChD,CAAC;AACH;AAEA,SAASI,uBAAuBA,CAACC,GAAuB;EACtD,IAAIA,GAAG,IAAI,IAAI,EAAE;IACf,OAAOC,SAAS;;EAElB,IAAI;IACF,IAAIC,GAAG,CAACF,GAAG,CAAC;IACZ,OAAOA,GAAG;GACX,CAAC,OAAOG,CAAC,EAAE;IACV,MAAM,IAAIC,KAAK,CACb,6DAA6DJ,GAAG,GAAG,CACpE;;AAEL;AAEA;;;;;AAKA,OAAM,SAAUK,sCAAsCA,CACpDC,yBAAyD,EACzDC,qBAAqD,EACrDC,oBAA2C;EAE3C,OAAO;IACL,GAAGnB,wCAAwC,CACzCiB,yBAAyB,EACzBC,qBAAqB,EACrBC,oBAAoB,CACrB;IACDZ,OAAO,EAAEL,YAAY,CACnBD,2BAA2B,CAACgB,yBAAyB,CAACV,OAAO,CAAC,EAC9DW,qBAAqB,CAACX,OAAO,EAC7BY,oBAAoB,CAACZ,OAAO,CAC7B;IACDI,GAAG,EACDD,uBAAuB,CAACO,yBAAyB,CAACN,GAAG,CAAC,IACtDO,qBAAqB,CAACP,GAAG,IACzBQ,oBAAoB,CAACR,GAAG;IAC1BS,YAAY,EACVH,yBAAyB,CAACG,YAAY,IACtCF,qBAAqB,CAACE,YAAY,IAClCD,oBAAoB,CAACC;GACxB;AACH;AAEA,OAAM,SAAUC,4BAA4BA,CAC1Cf,eAAuC,EACvCgB,kBAA0B;EAE1B,OAAO;IACL,GAAGvB,8BAA8B,EAAE;IACnCQ,OAAO,EAAEA,CAAA,KAAMD,eAAe;IAC9BK,GAAG,EAAE,wBAAwB,GAAGW,kBAAkB;IAClDF,YAAY,EAAE;MAAEG,SAAS,EAAE;IAAI;GAChC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}