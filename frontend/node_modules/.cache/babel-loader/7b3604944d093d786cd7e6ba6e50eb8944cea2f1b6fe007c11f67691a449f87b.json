{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getOtlpEncoder } from '../common/utils';\nimport { createInstrumentationScope, createResource, toAnyValue, toKeyValue } from '../common/internal';\nexport function createExportLogsServiceRequest(logRecords, options) {\n  const encoder = getOtlpEncoder(options);\n  return {\n    resourceLogs: logRecordsToResourceLogs(logRecords, encoder)\n  };\n}\nfunction createResourceMap(logRecords) {\n  const resourceMap = new Map();\n  for (const record of logRecords) {\n    const {\n      resource,\n      instrumentationScope: {\n        name,\n        version = '',\n        schemaUrl = ''\n      }\n    } = record;\n    let ismMap = resourceMap.get(resource);\n    if (!ismMap) {\n      ismMap = new Map();\n      resourceMap.set(resource, ismMap);\n    }\n    const ismKey = `${name}@${version}:${schemaUrl}`;\n    let records = ismMap.get(ismKey);\n    if (!records) {\n      records = [];\n      ismMap.set(ismKey, records);\n    }\n    records.push(record);\n  }\n  return resourceMap;\n}\nfunction logRecordsToResourceLogs(logRecords, encoder) {\n  const resourceMap = createResourceMap(logRecords);\n  return Array.from(resourceMap, ([resource, ismMap]) => ({\n    resource: createResource(resource),\n    scopeLogs: Array.from(ismMap, ([, scopeLogs]) => {\n      return {\n        scope: createInstrumentationScope(scopeLogs[0].instrumentationScope),\n        logRecords: scopeLogs.map(log => toLogRecord(log, encoder)),\n        schemaUrl: scopeLogs[0].instrumentationScope.schemaUrl\n      };\n    }),\n    schemaUrl: undefined\n  }));\n}\nfunction toLogRecord(log, encoder) {\n  return {\n    timeUnixNano: encoder.encodeHrTime(log.hrTime),\n    observedTimeUnixNano: encoder.encodeHrTime(log.hrTimeObserved),\n    severityNumber: toSeverityNumber(log.severityNumber),\n    severityText: log.severityText,\n    body: toAnyValue(log.body),\n    attributes: toLogAttributes(log.attributes),\n    droppedAttributesCount: log.droppedAttributesCount,\n    flags: log.spanContext?.traceFlags,\n    traceId: encoder.encodeOptionalSpanContext(log.spanContext?.traceId),\n    spanId: encoder.encodeOptionalSpanContext(log.spanContext?.spanId)\n  };\n}\nfunction toSeverityNumber(severityNumber) {\n  return severityNumber;\n}\nexport function toLogAttributes(attributes) {\n  return Object.keys(attributes).map(key => toKeyValue(key, attributes[key]));\n}","map":{"version":3,"names":["getOtlpEncoder","createInstrumentationScope","createResource","toAnyValue","toKeyValue","createExportLogsServiceRequest","logRecords","options","encoder","resourceLogs","logRecordsToResourceLogs","createResourceMap","resourceMap","Map","record","resource","instrumentationScope","name","version","schemaUrl","ismMap","get","set","ismKey","records","push","Array","from","scopeLogs","scope","map","log","toLogRecord","undefined","timeUnixNano","encodeHrTime","hrTime","observedTimeUnixNano","hrTimeObserved","severityNumber","toSeverityNumber","severityText","body","attributes","toLogAttributes","droppedAttributesCount","flags","spanContext","traceFlags","traceId","encodeOptionalSpanContext","spanId","Object","keys","key"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/otlp-transformer/src/logs/internal.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { ReadableLogRecord } from '@opentelemetry/sdk-logs';\nimport {\n  ESeverityNumber,\n  IExportLogsServiceRequest,\n  ILogRecord,\n  IResourceLogs,\n} from './internal-types';\nimport { Resource } from '@opentelemetry/resources';\nimport { Encoder, getOtlpEncoder } from '../common/utils';\nimport {\n  createInstrumentationScope,\n  createResource,\n  toAnyValue,\n  toKeyValue,\n} from '../common/internal';\nimport { SeverityNumber } from '@opentelemetry/api-logs';\nimport { OtlpEncodingOptions, IKeyValue } from '../common/internal-types';\nimport { LogAttributes } from '@opentelemetry/api-logs';\n\nexport function createExportLogsServiceRequest(\n  logRecords: ReadableLogRecord[],\n  options?: OtlpEncodingOptions\n): IExportLogsServiceRequest {\n  const encoder = getOtlpEncoder(options);\n  return {\n    resourceLogs: logRecordsToResourceLogs(logRecords, encoder),\n  };\n}\n\nfunction createResourceMap(\n  logRecords: ReadableLogRecord[]\n): Map<Resource, Map<string, ReadableLogRecord[]>> {\n  const resourceMap: Map<\n    Resource,\n    Map<string, ReadableLogRecord[]>\n  > = new Map();\n\n  for (const record of logRecords) {\n    const {\n      resource,\n      instrumentationScope: { name, version = '', schemaUrl = '' },\n    } = record;\n\n    let ismMap = resourceMap.get(resource);\n    if (!ismMap) {\n      ismMap = new Map();\n      resourceMap.set(resource, ismMap);\n    }\n\n    const ismKey = `${name}@${version}:${schemaUrl}`;\n    let records = ismMap.get(ismKey);\n    if (!records) {\n      records = [];\n      ismMap.set(ismKey, records);\n    }\n    records.push(record);\n  }\n  return resourceMap;\n}\n\nfunction logRecordsToResourceLogs(\n  logRecords: ReadableLogRecord[],\n  encoder: Encoder\n): IResourceLogs[] {\n  const resourceMap = createResourceMap(logRecords);\n  return Array.from(resourceMap, ([resource, ismMap]) => ({\n    resource: createResource(resource),\n    scopeLogs: Array.from(ismMap, ([, scopeLogs]) => {\n      return {\n        scope: createInstrumentationScope(scopeLogs[0].instrumentationScope),\n        logRecords: scopeLogs.map(log => toLogRecord(log, encoder)),\n        schemaUrl: scopeLogs[0].instrumentationScope.schemaUrl,\n      };\n    }),\n    schemaUrl: undefined,\n  }));\n}\n\nfunction toLogRecord(log: ReadableLogRecord, encoder: Encoder): ILogRecord {\n  return {\n    timeUnixNano: encoder.encodeHrTime(log.hrTime),\n    observedTimeUnixNano: encoder.encodeHrTime(log.hrTimeObserved),\n    severityNumber: toSeverityNumber(log.severityNumber),\n    severityText: log.severityText,\n    body: toAnyValue(log.body),\n    attributes: toLogAttributes(log.attributes),\n    droppedAttributesCount: log.droppedAttributesCount,\n    flags: log.spanContext?.traceFlags,\n    traceId: encoder.encodeOptionalSpanContext(log.spanContext?.traceId),\n    spanId: encoder.encodeOptionalSpanContext(log.spanContext?.spanId),\n  };\n}\n\nfunction toSeverityNumber(\n  severityNumber: SeverityNumber | undefined\n): ESeverityNumber | undefined {\n  return severityNumber as number | undefined as ESeverityNumber | undefined;\n}\n\nexport function toLogAttributes(attributes: LogAttributes): IKeyValue[] {\n  return Object.keys(attributes).map(key => toKeyValue(key, attributes[key]));\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}