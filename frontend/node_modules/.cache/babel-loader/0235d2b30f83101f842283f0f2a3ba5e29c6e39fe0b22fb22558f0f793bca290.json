{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag, createNoopMeter } from '@opentelemetry/api';\nimport { defaultResource } from '@opentelemetry/resources';\nimport { MeterProviderSharedState } from './state/MeterProviderSharedState';\nimport { MetricCollector } from './state/MetricCollector';\nimport { View } from './view/View';\n/**\n * This class implements the {@link MeterProvider} interface.\n */\nexport class MeterProvider {\n  _sharedState;\n  _shutdown = false;\n  constructor(options) {\n    this._sharedState = new MeterProviderSharedState(options?.resource ?? defaultResource());\n    if (options?.views != null && options.views.length > 0) {\n      for (const viewOption of options.views) {\n        this._sharedState.viewRegistry.addView(new View(viewOption));\n      }\n    }\n    if (options?.readers != null && options.readers.length > 0) {\n      for (const metricReader of options.readers) {\n        const collector = new MetricCollector(this._sharedState, metricReader);\n        metricReader.setMetricProducer(collector);\n        this._sharedState.metricCollectors.push(collector);\n      }\n    }\n  }\n  /**\n   * Get a meter with the configuration of the MeterProvider.\n   */\n  getMeter(name, version = '', options = {}) {\n    // https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/metrics/sdk.md#meter-creation\n    if (this._shutdown) {\n      diag.warn('A shutdown MeterProvider cannot provide a Meter');\n      return createNoopMeter();\n    }\n    return this._sharedState.getMeterSharedState({\n      name,\n      version,\n      schemaUrl: options.schemaUrl\n    }).meter;\n  }\n  /**\n   * Shut down the MeterProvider and all registered\n   * MetricReaders.\n   *\n   * Returns a promise which is resolved when all flushes are complete.\n   */\n  async shutdown(options) {\n    if (this._shutdown) {\n      diag.warn('shutdown may only be called once per MeterProvider');\n      return;\n    }\n    this._shutdown = true;\n    await Promise.all(this._sharedState.metricCollectors.map(collector => {\n      return collector.shutdown(options);\n    }));\n  }\n  /**\n   * Notifies all registered MetricReaders to flush any buffered data.\n   *\n   * Returns a promise which is resolved when all flushes are complete.\n   */\n  async forceFlush(options) {\n    // do not flush after shutdown\n    if (this._shutdown) {\n      diag.warn('invalid attempt to force flush after MeterProvider shutdown');\n      return;\n    }\n    await Promise.all(this._sharedState.metricCollectors.map(collector => {\n      return collector.forceFlush(options);\n    }));\n  }\n}","map":{"version":3,"names":["diag","createNoopMeter","defaultResource","MeterProviderSharedState","MetricCollector","View","MeterProvider","_sharedState","_shutdown","constructor","options","resource","views","length","viewOption","viewRegistry","addView","readers","metricReader","collector","setMetricProducer","metricCollectors","push","getMeter","name","version","warn","getMeterSharedState","schemaUrl","meter","shutdown","Promise","all","map","forceFlush"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/sdk-metrics/src/MeterProvider.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  diag,\n  MeterProvider as IMeterProvider,\n  Meter as IMeter,\n  MeterOptions,\n  createNoopMeter,\n} from '@opentelemetry/api';\nimport { defaultResource, Resource } from '@opentelemetry/resources';\nimport { IMetricReader } from './export/MetricReader';\nimport { MeterProviderSharedState } from './state/MeterProviderSharedState';\nimport { MetricCollector } from './state/MetricCollector';\nimport { ForceFlushOptions, ShutdownOptions } from './types';\nimport { View, ViewOptions } from './view/View';\n\n/**\n * MeterProviderOptions provides an interface for configuring a MeterProvider.\n */\nexport interface MeterProviderOptions {\n  /** Resource associated with metric telemetry  */\n  resource?: Resource;\n  views?: ViewOptions[];\n  readers?: IMetricReader[];\n}\n\n/**\n * This class implements the {@link MeterProvider} interface.\n */\nexport class MeterProvider implements IMeterProvider {\n  private _sharedState: MeterProviderSharedState;\n  private _shutdown = false;\n\n  constructor(options?: MeterProviderOptions) {\n    this._sharedState = new MeterProviderSharedState(\n      options?.resource ?? defaultResource()\n    );\n    if (options?.views != null && options.views.length > 0) {\n      for (const viewOption of options.views) {\n        this._sharedState.viewRegistry.addView(new View(viewOption));\n      }\n    }\n\n    if (options?.readers != null && options.readers.length > 0) {\n      for (const metricReader of options.readers) {\n        const collector = new MetricCollector(this._sharedState, metricReader);\n        metricReader.setMetricProducer(collector);\n        this._sharedState.metricCollectors.push(collector);\n      }\n    }\n  }\n\n  /**\n   * Get a meter with the configuration of the MeterProvider.\n   */\n  getMeter(name: string, version = '', options: MeterOptions = {}): IMeter {\n    // https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/metrics/sdk.md#meter-creation\n    if (this._shutdown) {\n      diag.warn('A shutdown MeterProvider cannot provide a Meter');\n      return createNoopMeter();\n    }\n\n    return this._sharedState.getMeterSharedState({\n      name,\n      version,\n      schemaUrl: options.schemaUrl,\n    }).meter;\n  }\n\n  /**\n   * Shut down the MeterProvider and all registered\n   * MetricReaders.\n   *\n   * Returns a promise which is resolved when all flushes are complete.\n   */\n  async shutdown(options?: ShutdownOptions): Promise<void> {\n    if (this._shutdown) {\n      diag.warn('shutdown may only be called once per MeterProvider');\n      return;\n    }\n\n    this._shutdown = true;\n\n    await Promise.all(\n      this._sharedState.metricCollectors.map(collector => {\n        return collector.shutdown(options);\n      })\n    );\n  }\n\n  /**\n   * Notifies all registered MetricReaders to flush any buffered data.\n   *\n   * Returns a promise which is resolved when all flushes are complete.\n   */\n  async forceFlush(options?: ForceFlushOptions): Promise<void> {\n    // do not flush after shutdown\n    if (this._shutdown) {\n      diag.warn('invalid attempt to force flush after MeterProvider shutdown');\n      return;\n    }\n\n    await Promise.all(\n      this._sharedState.metricCollectors.map(collector => {\n        return collector.forceFlush(options);\n      })\n    );\n  }\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAgBA,SACEA,IAAI,EAIJC,eAAe,QACV,oBAAoB;AAC3B,SAASC,eAAe,QAAkB,0BAA0B;AAEpE,SAASC,wBAAwB,QAAQ,kCAAkC;AAC3E,SAASC,eAAe,QAAQ,yBAAyB;AAEzD,SAASC,IAAI,QAAqB,aAAa;AAY/C;;;AAGA,OAAM,MAAOC,aAAa;EAChBC,YAAY;EACZC,SAAS,GAAG,KAAK;EAEzBC,YAAYC,OAA8B;IACxC,IAAI,CAACH,YAAY,GAAG,IAAIJ,wBAAwB,CAC9CO,OAAO,EAAEC,QAAQ,IAAIT,eAAe,EAAE,CACvC;IACD,IAAIQ,OAAO,EAAEE,KAAK,IAAI,IAAI,IAAIF,OAAO,CAACE,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;MACtD,KAAK,MAAMC,UAAU,IAAIJ,OAAO,CAACE,KAAK,EAAE;QACtC,IAAI,CAACL,YAAY,CAACQ,YAAY,CAACC,OAAO,CAAC,IAAIX,IAAI,CAACS,UAAU,CAAC,CAAC;;;IAIhE,IAAIJ,OAAO,EAAEO,OAAO,IAAI,IAAI,IAAIP,OAAO,CAACO,OAAO,CAACJ,MAAM,GAAG,CAAC,EAAE;MAC1D,KAAK,MAAMK,YAAY,IAAIR,OAAO,CAACO,OAAO,EAAE;QAC1C,MAAME,SAAS,GAAG,IAAIf,eAAe,CAAC,IAAI,CAACG,YAAY,EAAEW,YAAY,CAAC;QACtEA,YAAY,CAACE,iBAAiB,CAACD,SAAS,CAAC;QACzC,IAAI,CAACZ,YAAY,CAACc,gBAAgB,CAACC,IAAI,CAACH,SAAS,CAAC;;;EAGxD;EAEA;;;EAGAI,QAAQA,CAACC,IAAY,EAAEC,OAAO,GAAG,EAAE,EAAEf,OAAA,GAAwB,EAAE;IAC7D;IACA,IAAI,IAAI,CAACF,SAAS,EAAE;MAClBR,IAAI,CAAC0B,IAAI,CAAC,iDAAiD,CAAC;MAC5D,OAAOzB,eAAe,EAAE;;IAG1B,OAAO,IAAI,CAACM,YAAY,CAACoB,mBAAmB,CAAC;MAC3CH,IAAI;MACJC,OAAO;MACPG,SAAS,EAAElB,OAAO,CAACkB;KACpB,CAAC,CAACC,KAAK;EACV;EAEA;;;;;;EAMA,MAAMC,QAAQA,CAACpB,OAAyB;IACtC,IAAI,IAAI,CAACF,SAAS,EAAE;MAClBR,IAAI,CAAC0B,IAAI,CAAC,oDAAoD,CAAC;MAC/D;;IAGF,IAAI,CAAClB,SAAS,GAAG,IAAI;IAErB,MAAMuB,OAAO,CAACC,GAAG,CACf,IAAI,CAACzB,YAAY,CAACc,gBAAgB,CAACY,GAAG,CAACd,SAAS,IAAG;MACjD,OAAOA,SAAS,CAACW,QAAQ,CAACpB,OAAO,CAAC;IACpC,CAAC,CAAC,CACH;EACH;EAEA;;;;;EAKA,MAAMwB,UAAUA,CAACxB,OAA2B;IAC1C;IACA,IAAI,IAAI,CAACF,SAAS,EAAE;MAClBR,IAAI,CAAC0B,IAAI,CAAC,6DAA6D,CAAC;MACxE;;IAGF,MAAMK,OAAO,CAACC,GAAG,CACf,IAAI,CAACzB,YAAY,CAACc,gBAAgB,CAACY,GAAG,CAACd,SAAS,IAAG;MACjD,OAAOA,SAAS,CAACe,UAAU,CAACxB,OAAO,CAAC;IACtC,CAAC,CAAC,CACH;EACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}