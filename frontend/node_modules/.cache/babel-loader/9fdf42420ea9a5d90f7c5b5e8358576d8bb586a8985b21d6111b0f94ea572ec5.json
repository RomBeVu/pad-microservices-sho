{"ast":null,"code":"/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nclass BoundedQueueExportPromiseHandler {\n  _concurrencyLimit;\n  _sendingPromises = [];\n  /**\n   * @param concurrencyLimit maximum promises allowed in a queue at the same time.\n   */\n  constructor(concurrencyLimit) {\n    this._concurrencyLimit = concurrencyLimit;\n  }\n  pushPromise(promise) {\n    if (this.hasReachedLimit()) {\n      throw new Error('Concurrency Limit reached');\n    }\n    this._sendingPromises.push(promise);\n    const popPromise = () => {\n      const index = this._sendingPromises.indexOf(promise);\n      this._sendingPromises.splice(index, 1);\n    };\n    promise.then(popPromise, popPromise);\n  }\n  hasReachedLimit() {\n    return this._sendingPromises.length >= this._concurrencyLimit;\n  }\n  async awaitAll() {\n    await Promise.all(this._sendingPromises);\n  }\n}\n/**\n * Promise queue for keeping track of export promises. Finished promises will be auto-dequeued.\n * Allows for awaiting all promises in the queue.\n */\nexport function createBoundedQueueExportPromiseHandler(options) {\n  return new BoundedQueueExportPromiseHandler(options.concurrencyLimit);\n}","map":{"version":3,"names":["BoundedQueueExportPromiseHandler","_concurrencyLimit","_sendingPromises","constructor","concurrencyLimit","pushPromise","promise","hasReachedLimit","Error","push","popPromise","index","indexOf","splice","then","length","awaitAll","Promise","all","createBoundedQueueExportPromiseHandler","options"],"sources":["/home/senthilkumar/project/shopping-cart/frontend/node_modules/@opentelemetry/otlp-exporter-base/src/bounded-queue-export-promise-handler.ts"],"sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface IExportPromiseHandler {\n  pushPromise(promise: Promise<void>): void;\n  hasReachedLimit(): boolean;\n  awaitAll(): Promise<void>;\n}\n\nclass BoundedQueueExportPromiseHandler implements IExportPromiseHandler {\n  private readonly _concurrencyLimit: number;\n  private _sendingPromises: Promise<unknown>[] = [];\n\n  /**\n   * @param concurrencyLimit maximum promises allowed in a queue at the same time.\n   */\n  constructor(concurrencyLimit: number) {\n    this._concurrencyLimit = concurrencyLimit;\n  }\n\n  public pushPromise(promise: Promise<void>): void {\n    if (this.hasReachedLimit()) {\n      throw new Error('Concurrency Limit reached');\n    }\n\n    this._sendingPromises.push(promise);\n    const popPromise = () => {\n      const index = this._sendingPromises.indexOf(promise);\n      this._sendingPromises.splice(index, 1);\n    };\n    promise.then(popPromise, popPromise);\n  }\n\n  public hasReachedLimit(): boolean {\n    return this._sendingPromises.length >= this._concurrencyLimit;\n  }\n\n  public async awaitAll(): Promise<void> {\n    await Promise.all(this._sendingPromises);\n  }\n}\n\n/**\n * Promise queue for keeping track of export promises. Finished promises will be auto-dequeued.\n * Allows for awaiting all promises in the queue.\n */\nexport function createBoundedQueueExportPromiseHandler(options: {\n  concurrencyLimit: number;\n}): IExportPromiseHandler {\n  return new BoundedQueueExportPromiseHandler(options.concurrencyLimit);\n}\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAsBA,MAAMA,gCAAgC;EACnBC,iBAAiB;EAC1BC,gBAAgB,GAAuB,EAAE;EAEjD;;;EAGAC,YAAYC,gBAAwB;IAClC,IAAI,CAACH,iBAAiB,GAAGG,gBAAgB;EAC3C;EAEOC,WAAWA,CAACC,OAAsB;IACvC,IAAI,IAAI,CAACC,eAAe,EAAE,EAAE;MAC1B,MAAM,IAAIC,KAAK,CAAC,2BAA2B,CAAC;;IAG9C,IAAI,CAACN,gBAAgB,CAACO,IAAI,CAACH,OAAO,CAAC;IACnC,MAAMI,UAAU,GAAGA,CAAA,KAAK;MACtB,MAAMC,KAAK,GAAG,IAAI,CAACT,gBAAgB,CAACU,OAAO,CAACN,OAAO,CAAC;MACpD,IAAI,CAACJ,gBAAgB,CAACW,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;IACxC,CAAC;IACDL,OAAO,CAACQ,IAAI,CAACJ,UAAU,EAAEA,UAAU,CAAC;EACtC;EAEOH,eAAeA,CAAA;IACpB,OAAO,IAAI,CAACL,gBAAgB,CAACa,MAAM,IAAI,IAAI,CAACd,iBAAiB;EAC/D;EAEO,MAAMe,QAAQA,CAAA;IACnB,MAAMC,OAAO,CAACC,GAAG,CAAC,IAAI,CAAChB,gBAAgB,CAAC;EAC1C;;AAGF;;;;AAIA,OAAM,SAAUiB,sCAAsCA,CAACC,OAEtD;EACC,OAAO,IAAIpB,gCAAgC,CAACoB,OAAO,CAAChB,gBAAgB,CAAC;AACvE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}